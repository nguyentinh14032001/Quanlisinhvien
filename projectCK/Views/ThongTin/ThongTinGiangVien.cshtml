
@{
    ViewBag.Title = "ThongTinGiangVien";
    Layout = "~/Views/Shared/GiangVien__Layout.cshtml";
}

<link href="~/Content/using.css" rel="stylesheet">
<style>
    body {
        margin-top: 20px;
        color: #1a202c;
        text-align: left;
        background-color: #e2e8f0;
    }

    .main-body {
        margin-top: 72px;
        padding: 15px;
    }

    input.btn.btn-success.choosefile {
        width: 240px;
    }

    .card {
        box-shadow: 0 1px 3px 0 rgba(0,0,0,.1), 0 1px 2px 0 rgba(0,0,0,.06);
    }

    .card {
        position: relative;
        display: flex;
        flex-direction: column;
        min-width: 0;
        word-wrap: break-word;
        background-color: #fff;
        background-clip: border-box;
        border: 0 solid rgba(0,0,0,.125);
        border-radius: .25rem;
    }

    .card-body {
        flex: 1 1 auto;
        min-height: 1px;
        padding: 1rem;
    }

    .gutters-sm {
        margin-right: -8px;
        margin-left: -8px;
    }

        .gutters-sm > .col, .gutters-sm > [class*=col-] {
            padding-right: 8px;
            padding-left: 8px;
        }

    .mb-3, .my-3 {
        margin-bottom: 1rem !important;
    }

    .bg-gray-300 {
        background-color: #e2e8f0;
    }

    .h-100 {
        height: 100% !important;
    }

    .shadow-none {
        box-shadow: none !important;
    }

    .nutbam--1 {
        background-color: #37497e;
    }

    .thehovaten {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .hodemsv {
        display: flex;
        align-items: center;
    }

    .tensv {
        display: flex;
        align-items: center;
    }
</style>


@using (Html.BeginForm("suathongtingv", "ThongTin", FormMethod.Post, new { @class = "form-a" }))
{
    <div class="container">
        @foreach (var item in Model)
        {
            <div class="main-body">
                <div class="row gutters-sm">
                    <div class="col-md-4 mb-3">
                        <div class="card">
                            <div class="card-body">

                                <div class="d-flex flex-column align-items-center text-center">

                                    <img src="~/Content/IMG/@item.HinhAnh" class='rounded-circle' style="width:150px; height:150px;">
                                    <div class="mt-3">
                                        <h4>@item.MaGV</h4>
                                        <p class="text-secondary mb-1">Giảng viên đăng nhập hệ thống</p>
                                        <input type="file" name="HinhAnh" class="nutbam nutbam--1">
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="col-md-8">
                        <div class="card mb-3">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <h6 class="mb-0">Họ và tên</h6>
                                    </div>
                                    <div class="col-sm-9 text-secondary">
                                        <input class="form-control" name="TenDN" type="text" value="@item.MaGV" style="display:none;">
                                        <input class="form-control" name="HoTen" type="text" value="@item.HoTenGV">
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <h6 class="mb-0">Email</h6>
                                    </div>
                                    <div class="col-sm-9 text-secondary">

                                        <input class="form-control" name="Email" type="text" value="@item.Email">
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <h6 class="mb-0">Số điện thoại</h6>
                                    </div>
                                    <div class="col-sm-9 text-secondary">

                                        <input class="form-control" name="SDT" type="text" value="@item.SDT" />
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <h6 class="mb-0">Giới tính</h6>
                                    </div>
                                    <div class="col-sm-9 text-secondary">
                                        <select class="form-select" id="selectGT" name="GioiTinh" aria-label="Default select example">
                                            @if (@item.GioiTinh == false)
                                            {

                                                <option value="true">Nam</option>
                                                <option value="false" selected="selected">Nữ</option>

                                            }
                                            else
                                            {

                                                <option value="true" selected="selected">Nam</option>
                                                <option value="false">Nữ</option>

                                            }
                                        </select>
                                    </div>
                                </div>

                                <hr>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <h6 class="mb-0">Khoa</h6>
                                    </div>
                                    <div class="col-sm-9 text-secondary">

                                        <input class="form-control" id="tenlop" name="Lop" type="text" value="@item.Khoa.TenKhoa" />
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <h6 class="mb-0">Trình độ</h6>
                                    </div>
                                    <div class="col-sm-9 text-secondary">

                                        <input class="form-control" id="trinhdo" name="Lop" type="text" value="@item.TrinhDo" />
                                    </div>
                                </div>
                                <hr>
                                <div class="d-flex" style="align-items:center;">
                                    <div class="col-sm-3">
                                        <h6 class="mb-0">Mật khẩu</h6>
                                    </div>
                                    <div class="col-sm-3 text-secondary" style="display:flex; align-items:center;">
                                        <input class="form-control" n   ame="MatKhau" type="password" value="@item.MatKhau">
                                        <p style="color:red;">@ViewBag.thongbao</p>
                                    </div>
                                    <div style="margin-left:20px;"><a href="#" style="text-decoration:none" data-bs-toggle="modal" data-bs-target="#mdlExam">Đổi mật khẩu</a></div>

                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <button type="submit" class="btn btn-outline-info" style="float:right">
                                           Lưu
                                        </button>
                                        <a class="btn btn-info" href="@Url.Action("gv_Khoa_Index", "Khoas")">
                                            Quay về
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        }
    </div>
}
<script type="text/javascript">
    $(document).ready(function () {
        $('#tenlop').attr("readonly", true);
        $('#trinhdo').attr("readonly", true);
    });

</script>

<div class="modal" id="mdlExam">
    <div class="modal-dialog">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title" id="mdlExamLabel">Đổi mật khẩu</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal">
                </button>
            </div>

            <!-- Modal body -->
            <div class="modal-body" style="display: flex;flex-direction: column;align-items: center; justify-content:center">

                <div class="form-group">
                    <label for="txaName" class="form-label" style="margin-bottom: 1px!important">Nhập mật khẩu cũ</label>
                    <input class="form-control" type="password" id="txtMaCu" rows="1" />
                </div>
                <div class="form-group">
                    <label for="txaName" class="form-label" style="margin-bottom: 1px!important">Nhập mật khẩu mới</label>
                    <input class="form-control" type="password" id="txtMaMoi" rows="1" />
                </div>
                <div class="form-group">
                    <label for="txaName" class="form-label" style="margin-bottom: 1px!important">Nhập lại mật khẩu</label>
                    <input class="form-control" type="password" id="txtNhapLai" rows="1" />
                </div>

                <hr>
                <div class="modal-footer">
                    <a class="nutbam nutbam--1" id="btnSubmit">Xác nhận</a>
                    <button class="nutbam nutbam--1" data-bs-dismiss="modal">Trở về</button>
                </div>

            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).on('click', '#btnSubmit', function () {

        let macu = $('#txtMaCu').val();
        let mamoi = $('#txtMaMoi').val();
        let nhaplai = $('#txtNhapLai').val();
        if (macu.length == 0 || mamoi.length == 0 || nhaplai.length == 0 ) {
            alert("Vui lòng nhập đầy đủ thông tin");
            return;
        }
        if (mamoi != nhaplai) {
            alert("Mật khẩu nhập lại không khớp");
            return;
        }
          $.ajax({
                url: '@Url.Action("DoiMatKhauGV", "ThongTin")',
                type: 'post',
                data: {
                    macu: macu,
                    mamoi:mamoi,
                    nhaplai:nhaplai,
                },
                success: function (data) {
                    alert(data);
                    location.reload();
                }
            });
    });
</script>